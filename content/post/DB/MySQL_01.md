---
title: "[TIL] DB MySQL study: Query문 학습 1"
date: 2022-08-26T23:46:43+09:00
draft: false
summary: MySQL의 SQL에 대해 학습을 시작한다. SELECT, FROM, WHERE 와 비교연산자, 논리연산자, 산술연산자에 대해 학습해본다. 또한, 산술연산자에는 MySQL만의 오류가 있어서 날짜 계산 시, 어떻게 해야할지도 알아본다.
tags: ["TIL", "DB"]
categories: ["DB"]
---

# 0. Introduction


- 이번 장에서는 데이터 조회와 조건에 따른 데이터 필터링 관련 명령어를 학습한다.

- 쿼리문 작성 시, 컬럼 조회 실행 순서
    - `FROM` -> `WHERE` -> `GROUP BY` -> `HAVING` -> `SELECT` -> `OERDER BY`

<br>

---

# 1. SELECT, FROM, WHERE

## 1.1 SELECT, FROM 

- 조회 시에 사용하는 걸로, 사용하기 위한 선언을 하지 않아도 된다. 

- 만약 member schema의 bookstore table의 전체 칼럼을 조회한다면 다음과 같이 조회한다. 

```yml
SELECT * FROM member.bookstore;
```

- 그리고, bookstore에서 name, price coloumn을 조회하고 싶다면

```yml
SELECT name, price FROM member.bookstore;
```

<br>

## 1.2 WHERE 

> **_전체 데이터를 다 가져오는 것은 비용이 많이 들기 떄문에, 하지 말아야 한다. 그래서 WHERE를 사용하여 원하는 조건의 데이터만 가져온다._**

- WHERE절이란?
    - 내가 원하는 데이터만 보고 싶을 때 사용하는데, **SQL에서 쿼리 결과 필터링을 하는 중요한 기술**  

    - **단, _'조건이 참인 행만'_ 포함하도록 결과 집합을 필터링한다**  

- SELECT, UPDATE, DELETE 문에서 특정 행에 대한 조건을 설정할 때, **사용 특정 컬럼값을 비교하는 조건을 설정** 할 수 있다.  

- 위치: FROM 절 다음

    ```yml
    SELECT 컬럼명
    FROM 테이블명
    [WHERE 조건절]
    ```


- WHERE 절에는 연산자(operator)를 같이 사용한다.

### 주의사항과 해결책

- **주의사항**
    - ex)이름이 thor인 데이터만 보고싶은 경우
        - WHERE name = 'thor'
    - MySQL은 문자열을 대소문자 구분해서 인식을 하지 않는다!
    - WHERE name = 'thor'를 입력하면
    - 'Thor', 'THOR', 'thOr'를 다 동일한 'thor'로 인식한다.

- 해결책: 컬럼명 앞에 BINARY 입력
    - `WHERE BINARY name = 'Thor'`로 입력하면 대소문자를 구별한다. 

<br>

---

# 2. 비교연산자

## 2.1 = 

- 특정 데이터를 선택할 때 사용 
- equal을 의미 
- ex) Thor가 name인 데이터를 추출
    - `WHERE BINARY name = 'Thor'`

<br>

## 2.2 !=
    - 특정 데이터를 제외하여 선택할 때 사용 
    - <>를 사용했을 때와 같은 결과 출력 
    - ex) 출판사가 '김영사'가 아닌 데이터 추출 
        - `Where publisher != 김영사`

<br>

## 2.3 >=, >, <, <=

- 이외에 `>=`, `>`, `<`, `<=`이 있다. 
    - 프로그래밍 언어와 동일한 의미를 가지므로 건너띈다.

<br>

---

# 3. 논리연산자

## 3.1 AND, OR, IN, NOT

> 여러 가지 조건을 주고 싶을 때 또는, 조건을 계속 추가해야할 때 사용하는 논리 연산자

- 논리 연산자를 사용할 때는 **조건의 column 을 반드시 입력** 해야 한다. 
- 다음 사례를 통해 왜 그런지 알아보자.
    - ex) value가 10이거나 20인 행을 추출하고 싶은 경우 
    - 맞게 작성된 쿼리는 1번

    ```yml
    # 1: 정답
    WHERE value = 10 OR value = 20

    # 2: 원하는 값 추출 불가능하다. 20은 논리 연산자로 TRUE가 되어 모든 행을 반환한다.
    # 0은 FALSE이고, 나머지 숫자는 다 TRUE로 인식한다.
    WHERE value = 10 OR 20
    ```

- 논리 연산자를 계속 추가하면 복잡한 조건도 쉽게 필터링 가능
- 결과값으로 TRUE, FALSE 또는 NULL 반환한다.  

<br>

## 3.2 LIKE

> wildcard로 키워드가 들어간 것을 추출하는데 사용하여, 조회 조건 값이 명확하지 않을 때, 특정 내용을 찾을 수 있다. 

- 조건에 문자나 숫자를 포함할 수 있다.  
- % 또는 _와 함께 사용  (wildcard)
    - %: 조건을 포함하는 모든 문자를 의미  
    - _: 한글자를 의미 
        - _의 개수에 따라 뒤에 따라오는 문자열의 개수를 정할 수 있다. 
        - ex) `bo_`라고 지정하면 bob은 추출되지만, boka는 추출 X


- ex) 이름이 마이클로 시작하는 작가의 도서를 추출하고 싶다면?

    ```yml
    SELECT name, author 
    FROM member.bookstore 
    WHERE author LIKE '마이클%'
    ```

## 3.3 Between A and B

> A와 B를 포함하는 A와 B 사이의 값에 해당하는 행을 출력  

- 어디에 주로 사용하는가?
    - 주로 날짜 사이에 간격을 줄 때 자주 사용  
    - 최소값과 최대값을 지정한 값의 범위 내에 있는 값들을 검색하기 위해 사용 

<br>

## 3.4 IS NULL & IS NOT NULL

> NULL 값이 가진 값 또는 갖지 않는 값을 필터링

<br>

## 3.5 IN

> 컬럼이 한 가지 값에만 일치하는 것이 아닌 어떤 값들의 집합에 속할 때, 즉 조회하고자 하는 데이터 값이 여러개일 때 사용


- `=` 은 특정데이터 선택 시 사용. 조회하고 싶은 데이터가 여러개인 경우 IN을 사용  

```yml
# 잘못된 경우
SELECT *
FROM member.bookstore
WHERE author = ("유발하리라" , "한스로슬링");

# 올바른 경우
SELECT *
FROM member.bookstore
WHERE author IN ("유발하리라" , "한스로슬링");
```

<br>

---

# 4. 산술연산자

> 데이터값 계산하고자할 때 사용하며, 그 종류에는 +, -, *, / 가 있다.

- 산술표현식에는 숫자, 날짜, 산술 연산자 등이 포함
    - 문자열에는 산술연산자를 적용하면 숫자값으로 변경되어 추출

- SELECT, WHERE 문에서 사용


- 우선순위: 수학이랑 동일
    - () > *, / > +, -

- ❗️ 유의사항
    - 이 산술연산자를 사용하여 나온 coloumn은 계산하여 출력한 결과일 뿐, 새로운 열을 만들어 데이터베이스에 추가한 것이 아니라는 점에 유의하자.
    - 실무에서 비용계산 등에 매우 많이 사용
    - 특히 비즈니스를 위한 다양한 리포트를 작성하는데 필수  

❗️❗️ 산술연산자로 날짜를 계산할 때, 날짜 타입이 숫자타입으로 변경되어 지정된 날짜의 형식을 벗어난다. 이는 MySQL에서만 일어나는 것이다. 이에 대한 해결책은 **_날짜 연산 함수를 별도로 사용_** 해야, 숫자 타입으로 전환되지 않는다.

<br>

---